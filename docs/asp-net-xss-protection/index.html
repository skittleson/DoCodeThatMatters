<!DOCTYPE html>
<html lang="en-US" itemscope itemtype="http://schema.org/Blog" prefix="og: http://ogp.me/ns#">

<head>
    <title>ASP.NET XSS protection</title>
    <meta charset="utf-8">
    <base href="/">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta itemprop="description" name="description" content="Securing an ASP.NET WebApi for PCI application tests is no trivial matter.  It can take weeks of planning and the app to be analyzed.  After reviewing OWASP and other related XSS sites, the web.config was the first to be updated to prevent against attacks (MIIM &amp; XSS)." />
    <meta name="keywords" content="asp.net,xss,config" />
    <meta name="Distribution" content="Global" />
    <meta name="Rating" content="General" />
    <meta name="Robots" content="INDEX,FOLLOW" />
    <meta name="author" content="Do Code That Matters" />
    <meta name="Revisit-after" content="31 Days" />
    <meta name="application-name" content="Do Code That Matters">
    <meta property="og:title" content="ASP.NET XSS protection | Do Code That Matters" />
    <meta property="og:type" content="blog" />
    <meta property="og:description" content="Securing an ASP.NET WebApi for PCI application tests is no trivial matter.  It can take weeks of planning and the app to be analyzed.  After reviewing OWASP and other related XSS sites, the web.config was the first to be updated to prevent against attacks (MIIM &amp; XSS)." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Do Code That Matters" />
    <meta name="twitter:description" content="Securing an ASP.NET WebApi for PCI application tests is no trivial matter.  It can take weeks of planning and the app to be analyzed.  After reviewing OWASP and other related XSS sites, the web.config was the first to be updated to prevent against attacks (MIIM &amp; XSS)." />
    <link href="/css/site.css" rel="stylesheet">
    <link rel='manifest' href='/manifest.webmanifest'>
    <link rel="alternate" type="application/rss+xml" title="My Test Feed" href="https://DoCodeThatMatters.com/rss.xml" />
</head>

<body>

    <header class="navbar">
        <section class="navbar-section">
            <a href="/" class="navbar-brand mr-2">Do Code<div class='small-device'></div> That Matters</a>
            <a href="/blog" class="btn btn-link">Blog</a>
            <a href="/about" class="btn btn-link">About</a>        </section>
    </header><main class="postMain">
  <article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <meta itemprop="mainEntityOfPage" content="asp-net-xss-protection">
      <h1 itemprop="name headline">ASP.NET XSS protection</h1>
      <small>
        <time itemprop="datePublished" content="2017-09-06T00:00:00.000Z">5 September 2017</time>
        <meta itemprop="dateModified" content="2017-09-06T00:00:00.000Z">
        by
        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
          <a rel="author" itemprop="url" href="https://DoCodeThatMatters.com/about" title="View author biography">
            <span itemprop="name">Spencer Kittleson</span>
          </a>
          <meta itemprop="jobTitle" content="Software Engineer">
        </span>
      </small>
      <br />
      <figure itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
        <img itemprop="url contentUrl" alt="ASP.Net XSS protection" src="/images/SSL-Featured.png">
        <figcaption itemprop="caption">ASP.Net XSS protection</figcaption>
      </figure>
      <br />
    </header>
    <section itemprop="articleBody">
      <p>Securing an ASP.NET WebApi for PCI application tests is no trivial matter.  It can take weeks of planning and the app to be analyzed.  After reviewing OWASP and other related XSS sites, the web.config was the first to be updated to prevent against attacks (MIIM &amp; XSS).</p>
<p>In system.webServer element, add the following:</p>
<pre><code>&lt;httpProtocol&gt;
  &lt;customHeaders&gt;
    &lt;remove name=&quot;Server&quot; /&gt;
    &lt;remove name=&quot;X-Powered-By&quot; /&gt;
    &lt;remove name=&quot;X-Frame-Options&quot; /&gt;
    &lt;remove name=&quot;X-XSS-Protection&quot; /&gt;
    &lt;remove name=&quot;X-Content-Type-Options&quot; /&gt;
    &lt;remove name=&quot;Cache-Control&quot; /&gt;
    &lt;remove name=&quot;Pragma&quot; /&gt;
    &lt;remove name=&quot;Expires&quot; /&gt;
    &lt;remove name=&quot;Content-Security-Policy&quot; /&gt;
    &lt;clear /&gt; &lt;!-- removing anything set by IIS --&gt;
    &lt;add name=&quot;X-Frame-Options&quot; value=&quot;DENY&quot; /&gt;
    &lt;add name=&quot;X-XSS-Protection&quot; value=&quot;1; mode=block&quot; /&gt;
    &lt;add name=&quot;X-Content-Type-Options&quot; value=&quot;nosniff&quot; /&gt;
    &lt;add name=&quot;Cache-Control&quot; value=&quot;no-cache, no-store, must-revalidate&quot; /&gt; &lt;!-- cache could be altered --&gt;
    &lt;add name=&quot;Pragma&quot; value=&quot;no-cache&quot; /&gt; &lt;!-- cache could be altered --&gt;
    &lt;add name=&quot;Expires&quot; value=&quot;Sun, 1 Jan 1990 00:00:00 UTC&quot; /&gt; &lt;!-- cache could be altered so set far in past and not -1 --&gt;
    &lt;add name=&quot;Content-Security-Policy&quot; value=&quot;default-src 'self' 'unsafe-inline' data; font-src *; img-src https://*;&quot; /&gt; &lt;!-- where resources can come from --&gt;
  &lt;/customHeaders&gt;
&lt;/httpProtocol&gt;
</code></pre>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content security policy</a> was the only one considered less secure due to outside javascript &amp; CSS resources the app used (Google Analytics, Bootstrap, etc).</p>
<h2>Additional Protection</h2>
<ul>
<li>Applying AntiXss attribute from the <a href="https://bitbucket.org/embarr-development/asp.net-web-api-antixss-attribute">ASP.Net Web API AntiXss Attribute</a> project. Check it out here: https://bitbucket.org/embarr-development/asp.net-web-api-antixss-attribute</li>
<li>Use a Website Application Firewall for your apps.
<ul>
<li>Amazon WAF, ModSecurity, IronBee, NAXSI, WebKnight, Shadow Daemon</li>
</ul>
</li>
</ul>
<h2>Tools</h2>
<p>Look for open source tools that are commonly used for penetration testing. These tools gave some pretty good insight on where the app needed securing.</p>
<ul>
<li><a href="https://cirt.net/Nikto2">nikto2</a></li>
<li><a href="http://sqlmap.org/">sqlmap</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project">OWASP Zap</a></li>
</ul>
<h2>Takeaways</h2>
<ul>
<li>Don't rely on just one layer of protection.</li>
<li>Use established frameworks.</li>
<li>Use the same tools as the pen testers.</li>
</ul>
<h2>References</h2>
<ul>
<li><a href="https://stackoverflow.com/search?q=XSS">https://stackoverflow.com/search?q=XSS</a> (21k and counting!)</li>
<li><a href="https://www.owasp.org/index.php/Main_Page">OWASP</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/ff649310.aspx">https://msdn.microsoft.com/en-us/library/ff649310.aspx</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP</a></li>
</ul>

    </section>
    <span itemprop="publisher" itemscope itemtype="https://schema.org/Person">
      <meta itemprop="name" content="Spencer Kittleson">
    </span>
  </article>
</main>
<aside class="postAside">
  <b>Resources</b>
  <br />
  Twitter: <a href="https://twitter.com/skittleson">@skittleson</a><br />
  GitHub: <a href="https://github.com/skittleson">skittleson</a><br />
  LinkedIn: <a href="https://www.linkedin.com/in/skittleson/">skittleson</a><br />
  StackOverflow: <a href=" https://stackoverflow.com/users/2414540/spencer">spencer</a><br />  <b>Latest Posts</b>
  <ul class="unstyledUl">
  </ul>
  <br />
  <b>Other</b><br />
  See something inaccurate or need more detail? Submit a <a href="https://github.com/skittleson/DoCodeThatMatters">Pull
    Request</a> to help me out!
</aside>

<div id="footer">
    <div class="container">
        <div class="row hidden-xs">
            <div class="col-sm-12 text-center">

                <span itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <a rel="author" itemprop="url" href="https://DoCodeThatMatters.com/about" title="View author biography">
                        <span itemprop="name">Spencer Kittleson</span>
                    </a>
                    <meta itemprop="jobTitle" content="Software Engineer">
                </span>
                | 
                &copy; 2019 Do Code That Matters
            </div>
        </div>
    </div>
</div>
<script async src="js/site.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-93963699-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-93963699-1');
</script>
</body>

</html>